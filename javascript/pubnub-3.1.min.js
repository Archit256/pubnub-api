pubnub-3.1.min.js(window.JSON&&window.JSON["stringify"])||(function(){window.JSON||(window.JSON={});if(typeof String.prototype.toJSON!=="function"){String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text){return eval("("+text+")")}}}());window.PUBNUB||(function(){window.console||(window.console=window.console||{});console.log||(console.log=((window.opera||{}).postError||function(){}));function c(){return"x"+ ++o+""+(+new Date)}function A(){return +new Date}var r=(function(){var O=window.localStorage;return{get:function(P){try{if(O){return O.getItem(P)}if(document.cookie.indexOf(P)==-1){return null}return((document.cookie||"").match(RegExp(P+"=([^;]+)"))||[])[1]||null}catch(Q){return}},set:function(P,Q){try{if(O){return O.setItem(P,Q)&&0}document.cookie=P+"="+Q+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(R){return}}}})();var o=1,m="https://dh15atwfs066y.cloudfront.net/pubnub.swf",E=/{([\w\-]+)}/g,H="async",p="/",F=310000,g=1000,z=navigator.userAgent,a=z.indexOf("MSIE 6")==-1;var t=(function(){var O=Math.floor(Math.random()*9)+1;return function(P){return P.indexOf("pubsub")>0&&P.replace("pubsub","ps"+(++O<10?O:O=1))||P}})();function M(P,Q){var S,R=0,O=function(){if(R+Q>A()){clearTimeout(S);S=setTimeout(O,Q)}else{R=A();P()}};return O}function C(O){return document.getElementById(O)}function h(O){console.log(O)}function L(P,Q){var O=[];I(P.split(/\s+/),function(R){I((Q||document).getElementsByTagName(R),function(S){O.push(S)})});return O}function I(R,Q){if(!R||!Q){return}if(typeof R[0]!="undefined"){for(var P=0,O=R.length;P<O;){Q.call(R[P],R[P],P++)}}else{for(var P in R){R.hasOwnProperty&&R.hasOwnProperty(P)&&Q.call(R[P],P,R[P])}}}function y(P,O){var Q=[];I(P||[],function(S,R){Q.push(O(S,R))});return Q}function N(P,O){var Q=[];I(P||[],function(R){O(R)&&Q.push(R)});return Q}function w(P,O){return P.replace(E,function(R,Q){return O[Q]||R})}function f(Q,P,O){I(Q.split(","),function(S){var R=function(T){if(!T){T=window.event}if(!O(T)){T.cancelBubble=true;T.returnValue=false;T.preventDefault&&T.preventDefault();T.stopPropagation&&T.stopPropagation()}};if(P.addEventListener){P.addEventListener(S,R,false)}else{if(P.attachEvent){P.attachEvent("on"+S,R)}else{P["on"+S]=R}}})}function u(Q,P,O){if(P.removeEventListener){P.removeEventListener(Q,false)}else{if(P.detachEvent){P.detachEvent("on"+Q,false)}else{P["on"+Q]=null}}}function q(){return L("head")[0]}function s(P,O,Q){if(Q){P.setAttribute(O,Q)}else{return P&&P.getAttribute&&P.getAttribute(O)}}function G(O,Q){for(var P in Q){if(Q.hasOwnProperty(P)){try{O.style[P]=Q[P]+("|width|height|top|left|".indexOf(P)>0&&typeof Q[P]=="number"?"px":"")}catch(R){}}}}function i(O){return document.createElement(O)}function K(O,P){return setTimeout(O,P)}function v(){return a||B()?0:c()}function d(O){return y((encodeURIComponent(O)).split(""),function(P){return"-_.!~*'()".indexOf(P)<0?P:"%"+P.charCodeAt(0).toString(16).toUpperCase()}).join("")}var x={list:{},unbind:function(O){x.list[O]=[]},bind:function(P,O){(x.list[P]=x.list[P]||[]).push(O)},fire:function(O,P){I(x.list[O]||[],function(Q){Q(P)})}};function n(S){if(a||B()){return D(S)}var V=i("script"),W=S.callback,O=c(),T=0,P=K(function(){U(1)},F),R=S.fail||function(){},X=S.success||function(){},Q=function(){q().appendChild(V)},U=function(Y,Z){if(T){return}T=1;Y||X(Z);V.onerror=null;clearTimeout(P);K(function(){Y&&R();var aa=C(O),ab=aa&&aa.parentNode;ab&&ab.removeChild(aa)},g)};window[W]=function(Y){U(0,Y)};V[H]=H;V.onerror=function(){U(1)};V.src=S.url.join(p);if(S.data){V.src+="?";for(key in S.data){V.src+=key+"="+S.data[key]+"&"}}s(V,"id",O);Q();return U}function D(R){var X,S=function(){if(V){return}V=1;clearTimeout(O);try{response=JSON.parse(X.responseText)}catch(Y){return T(1)}W(response)},P=0,V=0,O=K(function(){T(1)},F),Q=R.fail||function(){},W=R.success||function(){},T=function(Y){if(P){return}P=1;clearTimeout(O);if(X){X.onerror=X.onload=null;X.abort&&X.abort();X=null}Y&&Q()};try{X=B()||window.XDomainRequest&&new XDomainRequest()||new XMLHttpRequest();X.onerror=X.onabort=function(){T(1)};X.onload=X.onloadend=S;X.timeout=F;url=R.url.join(p);if(R.data){url+="?";for(key in R.data){url+=key+"="+R.data[key]+"&"}}X.open("GET",url,true);X.send()}catch(U){T(0);a=0;return n(R)}return T}var k=C("pubnub")||{},j=0,b=[],J=function(O){var T={},R=O.publish_key||"",Q=O.subscribe_key||"",V=O.ssl?"s":"",U=O.uuid||r.get(Q+"uuid")||"",P="http"+V+"://"+(O.origin||"pubsub.pubnub.com"),S={history:function(X,aa){var aa=X.callback||aa,W=X.limit||100,Y=X.channel,Z=v();if(!Y){return h("Missing Channel")}if(!aa){return h("Missing Callback")}n({callback:Z,url:[P,"history",Q,d(Y),Z,W],success:function(ab){aa(ab)},fail:function(ab){h(ab)}})},time:function(X){var W=v();n({callback:W,url:[P,"time",W],success:function(Y){X(Y[0])},fail:function(){X(0)}})},uuid:function(X){var W="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(aa){var Z=Math.random()*16|0,Y=aa=="x"?Z:(Z&3|8);return Y.toString(16)});if(X){X(W)}return W},publish:function(X,ab){var ab=ab||X.callback||function(){},Z=X.message,Y=X.channel,aa=v(),W;if(!Z){return h("Missing Message")}if(!Y){return h("Missing Channel")}if(!R){return h("Missing Publish Key")}Z=JSON.stringify(Z);W=[P,"publish",R,Q,0,d(Y),aa,d(Z)];n({callback:aa,success:function(ac){ab(ac)},fail:function(){ab([0,"Disconnected"])},url:W,data:{uuid:U}})},unsubscribe:function(W){var X=W.channel;if(!(X in T)){return}T[X].connected=0;T[X].done&&T[X].done(0)},subscribe:function(ac,aj){var aa=ac.channel,aj=aj||ac.callback,ae=ac.subscribe_key||Q,ab=ac.restore,ah=0,ad=ac.error||function(){},ak=ac.connect||function(){},W=ac.reconnect||function(){},ai=ac.disconnect||function(){},Y=ac.presence||function(){},af=0,X=0,ag=t(P);if(!j){return b.push([ac,aj,S])}if(!aa){return h("Missing Channel")}if(!aj){return h("Missing Callback")}if(!Q){return h("Missing Subscribe Key")}if(!(aa in T)){T[aa]={}}if(T[aa].connected&&!Y){return h("Already Connected")}T[aa].connected=1;function Z(){var al=v();if(!T[aa].connected){return}T[aa].done=n({callback:al,url:[ag,"subscribe",ae,d(aa),al,ah],data:{uuid:U},fail:function(){if(!af){af=1;ai()}K(Z,g);S.time(function(am){if(am&&af){af=0;W()}else{ad()}})},success:function(am){if(!T[aa].connected){return}if(!X){X=1;ak()}if(af){af=0;W()}ab=r.set(Q+aa,ah=ab&&r.get(ae+aa)||am[1]);I(am[0],function(an){aj(an,am)});K(Z,10)},})}Z();if(ac.presence){S.subscribe({channel:ac.channel,subscribe_key:Q+"-pres",callback:Y,restore:ac.restore})}},here_now:function(X,aa){var aa=X.callback||aa,Y=X.channel,Z=v(),W=t(P);if(!Y){return h("Missing Channel")}if(!aa){return h("Missing Callback")}data=null;if(Z!="0"){data.callback=Z}n({callback:Z,url:[W,"v2","presence","sub_key",Q,"channel",d(Y)],data:data,success:function(ab){aa(ab)},fail:function(ab){h(ab)}})},xdr:n,ready:e,db:r,each:I,map:y,css:G,"$":C,create:i,bind:f,supplant:w,head:q,search:L,attr:s,now:A,unique:c,events:x,updater:M,init:J};if(U==""){U=S.uuid()}r.set(Q+"uuid",U);return S};PUBNUB=J({publish_key:s(k,"pub-key"),subscribe_key:s(k,"sub-key"),ssl:s(k,"ssl")=="on",origin:s(k,"origin"),uuid:s(k,"uuid")});G(k,{position:"absolute",top:-g});if("opera" in window||s(k,"flash")){k.innerHTML="<object id=pubnubs data="+m+"><param name=movie value="+m+"><param name=allowscriptaccess value=always></object>"}var l=C("pubnubs")||{};function e(){PUBNUB.time(A);PUBNUB.time(function(O){K(function(){if(j){return}j=1;I(b,function(P){P[2]["subscribe"](P[0],P[1])})},g)})}f("load",window,function(){K(e,0)});PUBNUB.rdx=function(P,O){if(!O){return B[P]["onerror"]()}B[P]["responseText"]=unescape(O);B[P]["onload"]()};function B(){if(!l.get){return 0}var O={id:B.id++,send:function(){},abort:function(){O.id={}},open:function(Q,P){B[O.id]=O;l.get(O.id,P)}};return O}B.id=g;window.jQuery&&(window.jQuery["PUBNUB"]=PUBNUB);typeof module!=="undefined"&&(module.exports=PUBNUB)&&e()})();